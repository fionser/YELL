#pragma once
#include <cinttypes>
namespace yell {

struct params {
#ifdef __APPLE__
  using uint128_t = __uint128_t;
#else
  using uint128_t = unsigned int __attribute__((mode(TI)));
#endif
  using value_type = uint32_t;
  using signed_type = int32_t;
  using gt_value_type = uint64_t;
  using float_type = double;
  static constexpr unsigned int kMaxNbModuli = 291;
  static constexpr unsigned int kMaxPolyDegree = 32768;
  static constexpr unsigned int kModulusBitsize = 30;
  static constexpr unsigned int kModulusRepresentationBitsize = 32;
  // The moduli used in each 32 bit block (30 bits long each)
  // They are of the form p = 2**30 - i*2**14 + 1 for increasing i
  static constexpr value_type P[kMaxNbModuli] = { 1073479681UL, 1072496641UL, 1071513601UL, 1070727169UL, 1069219841UL, 1068564481UL, 1068433409UL, 1068236801UL, 1065811969UL, 1065484289UL, 1064697857UL, 1063452673UL, 1063321601UL, 1063059457UL, 1062862849UL, 1062535169UL, 1062469633UL, 1061093377UL, 1060765697UL, 1060700161UL, 1060175873UL, 1058209793UL, 1056440321UL, 1056178177UL, 1055260673UL, 1054212097UL, 1054015489UL, 1053818881UL, 1052835841UL, 1052508161UL, 1051721729UL, 1049100289UL, 1048772609UL, 1048707073UL, 1048379393UL, 1045430273UL, 1043464193UL, 1042415617UL, 1041694721UL, 1040908289UL, 1040842753UL, 1040056321UL, 1038745601UL, 1038155777UL, 1037303809UL, 1036779521UL, 1034813441UL, 1033961473UL, 1032650753UL, 1032257537UL, 1032192001UL, 1031667713UL, 1030619137UL, 1029308417UL, 1028456449UL, 1026686977UL, 1026490369UL, 1026162689UL, 1025703937UL, 1023148033UL, 1022164993UL, 1021444097UL, 1021247489UL, 1020592129UL, 1019805697UL, 1019609089UL, 1019478017UL, 1018429441UL, 1018101761UL, 1017839617UL, 1016922113UL, 1016463361UL, 1015283713UL, 1014366209UL, 1012989953UL, 1012924417UL, 1012596737UL, 1012334593UL, 1012006913UL, 1011023873UL, 1010761729UL, 1010565121UL, 1009975297UL, 1008795649UL, 1008271361UL, 1007681537UL, 1006108673UL, 1005649921UL, 1005518849UL, 1005060097UL, 1004535809UL, 1004339201UL, 1002766337UL, 1002373121UL, 1000800257UL, 1000210433UL, 999948289UL, 999424001UL, 999161857UL, 998572033UL, 998244353UL, 997261313UL, 996278273UL, 995622913UL, 995033089UL, 994902017UL, 994705409UL, 994246657UL, 993918977UL, 993329153UL, 993263617UL, 992083969UL, 991887361UL, 991363073UL, 991297537UL, 990576641UL, 989986817UL, 989003777UL, 988938241UL, 988610561UL, 986382337UL, 985661441UL, 985464833UL, 985006081UL, 984481793UL, 983826433UL, 982450177UL, 982056961UL, 981270529UL, 980746241UL, 980156417UL, 979107841UL, 978780161UL, 977993729UL, 977534977UL, 976355329UL, 976224257UL, 975831041UL, 975634433UL, 975175681UL, 974979073UL, 974258177UL, 973406209UL, 972029953UL, 971898881UL, 971243521UL, 970129409UL, 969146369UL, 967507969UL, 967180289UL, 966197249UL, 964558849UL, 962854913UL, 962592769UL, 962396161UL, 961085441UL, 959119361UL, 958922753UL, 958136321UL, 957939713UL, 957677569UL, 957546497UL, 957349889UL, 956366849UL, 955383809UL, 954531841UL, 954335233UL, 952434689UL, 952238081UL, 952041473UL, 951582721UL, 950468609UL, 950403073UL, 950009857UL, 949682177UL, 949616641UL, 949420033UL, 948699137UL, 948633601UL, 947847169UL, 946339841UL, 944570369UL, 944177153UL, 943718401UL, 942800897UL, 941424641UL, 940572673UL, 939655169UL, 938475521UL, 936312833UL, 935329793UL, 935264257UL, 933888001UL, 933101569UL, 932970497UL, 932904961UL, 932577281UL, 930742273UL, 930021377UL, 929955841UL, 929366017UL, 927662081UL, 927072257UL, 926220289UL, 925892609UL, 924844033UL, 924712961UL, 924450817UL, 924254209UL, 922877953UL, 922550273UL, 921894913UL, 921501697UL, 920518657UL, 920322049UL, 919601153UL, 919339009UL, 918552577UL, 918224897UL, 917569537UL, 917176321UL, 916389889UL, 915996673UL, 915013633UL, 914685953UL, 914096129UL, 913899521UL, 913309697UL, 913244161UL, 912130049UL, 911081473UL, 910491649UL, 909770753UL, 909377537UL, 909180929UL, 908328961UL, 908197889UL, 908132353UL, 907804673UL, 907542529UL, 907411457UL, 907214849UL, 907018241UL, 906362881UL, 904265729UL, 903282689UL, 903086081UL, 902627329UL, 902430721UL, 900923393UL, 900857857UL, 900464641UL, 899678209UL, 898301953UL, 897712129UL, 897581057UL, 897318913UL, 896991233UL, 896729089UL, 896204801UL, 896008193UL, 894959617UL, 893255681UL, 893059073UL, 892403713UL, 891617281UL, 890437633UL, 889454593UL, 889323521UL, 889126913UL, 889061377UL, 888668161UL, 887488513UL, 885719041UL, 885522433UL, 883949569UL, 882245633UL, 881983489UL, 881590273UL, 880869377UL, 880803841UL, 880214017UL, 879230977UL, 876675073UL, 875298817UL, 874708993UL, 874315777UL, 873725953UL, 873332737UL, 873136129UL, 873005057UL};


  // The associated lower word of their Newton quotients, i.e., low 32 bit of 2^64 / p[i]
  static constexpr value_type Pn[kMaxNbModuli] = { 4195312UL, 19946058UL, 35725705UL, 48370285UL, 72657720UL, 83238847UL, 85356630UL, 88534279UL, 127821675UL, 133144498UL, 145932640UL, 166219214UL, 168357407UL, 172635374UL, 175845234UL, 181197641UL, 182268519UL, 204787504UL, 210157780UL, 211232233UL, 219832642UL, 252160074UL, 281357642UL, 285691528UL, 300877086UL, 318264375UL, 321528344UL, 324793530UL, 341137753UL, 346592611UL, 359698141UL, 403525146UL, 409018927UL, 410118095UL, 415615997UL, 465252207UL, 498498887UL, 516281730UL, 528528201UL, 541907334UL, 543023174UL, 556424227UL, 578804408UL, 588893926UL, 603487932UL, 612480780UL, 646285118UL, 660973589UL, 683618563UL, 690423269UL, 691557891UL, 700640054UL, 718832102UL, 741624285UL, 756470358UL, 787383237UL, 790824580UL, 796563082UL, 804603145UL, 849529767UL, 866869062UL, 879605757UL, 883082522UL, 894681412UL, 908619758UL, 912107704UL, 914433749UL, 933063662UL, 938893380UL, 943559856UL, 959911471UL, 968098348UL, 989184290UL, 1005618374UL, 1030325318UL, 1031503514UL, 1037396781UL, 1042114141UL, 1048014278UL, 1065737637UL, 1070469688UL, 1074020338UL, 1084680581UL, 1106038464UL, 1115546898UL, 1126255713UL, 1154873939UL, 1163237784UL, 1165628856UL, 1174002518UL, 1183581783UL, 1187176586UL, 1215985755UL, 1223202174UL, 1252124557UL, 1262993902UL, 1267828838UL, 1277506319UL, 1282348868UL, 1293253899UL, 1299317818UL, 1317533485UL, 1335785100UL, 1347972866UL, 1358955582UL, 1361397954UL, 1365062719UL, 1373619473UL, 1379736277UL, 1390756693UL, 1391981992UL, 1414065049UL, 1417750665UL, 1427586122UL, 1428816286UL, 1442358829UL, 1453453762UL, 1471974724UL, 1473210764UL, 1479393422UL, 1521544438UL, 1535222333UL, 1538956141UL, 1547674157UL, 1557647553UL, 1570129245UL, 1596395002UL, 1603913026UL, 1618967149UL, 1629016644UL, 1640335177UL, 1660490683UL, 1666798135UL, 1681953266UL, 1690805019UL, 1713604867UL, 1716141585UL, 1723755827UL, 1727565250UL, 1736459876UL, 1740274421UL, 1754274258UL, 1770846255UL, 1797677769UL, 1800237115UL, 1813044204UL, 1834855967UL, 1854143286UL, 1886375916UL, 1892835546UL, 1912240727UL, 1944670591UL, 1978514726UL, 1983732151UL, 1987647085UL, 2013787578UL, 2053132279UL, 2057075623UL, 2072865181UL, 2076816621UL, 2082087732UL, 2084724369UL, 2088680680UL, 2108486631UL, 2128333341UL, 2145566889UL, 2149548232UL, 2188119284UL, 2192118181UL, 2196118729UL, 2205459770UL, 2228182695UL, 2229520997UL, 2237554685UL, 2244254507UL, 2245595026UL, 2249617694UL, 2264381742UL, 2265725041UL, 2281859116UL, 2312857714UL, 2349373611UL, 2357506842UL, 2367004177UL, 2386026576UL, 2414629696UL, 2432378336UL, 2451528250UL, 2476204587UL, 2521606031UL, 2542312459UL, 2543694435UL, 2572760739UL, 2589408552UL, 2592185916UL, 2593574891UL, 2600522692UL, 2639520789UL, 2654883575UL, 2656281373UL, 2668870425UL, 2705328725UL, 2717980130UL, 2736282829UL, 2743331297UL, 2765919960UL, 2768747145UL, 2774403920UL, 2778648606UL, 2808412054UL, 2815511678UL, 2829726067UL, 2838264405UL, 2859642164UL, 2863923196UL, 2879635975UL, 2885355823UL, 2902534954UL, 2909701610UL, 2924050279UL, 2932669322UL, 2949929600UL, 2958570853UL, 2980206478UL, 2987428688UL, 3000441713UL, 3004783121UL, 3017818560UL, 3019267981UL, 3043940012UL, 3067215868UL, 3080332097UL, 3096386139UL, 3105153618UL, 3109540201UL, 3128570671UL, 3131501605UL, 3132967389UL, 3140299484UL, 3146168973UL, 3149104989UL, 3153510603UL, 3157918128UL, 3172623686UL, 3219824713UL, 3242025642UL, 3246471628UL, 3256853127UL, 3261305572UL, 3295505544UL, 3296995096UL, 3305936958UL, 3323844131UL, 3355257130UL, 3368749329UL, 3371750003UL, 3377753982UL, 3385263890UL, 3391275769UL, 3403310077UL, 3407826573UL, 3431948068UL, 3471266281UL, 3475812653UL, 3490981693UL, 3509213976UL, 3536622785UL, 3559518997UL, 3562575649UL, 3567162318UL, 3568691658UL, 3577872437UL, 3605463587UL, 3646988114UL, 3651612194UL, 3688678887UL, 3728983615UL, 3735198165UL, 3744526920UL, 3761651267UL, 3763209416UL, 3777243197UL, 3800674673UL, 3861842439UL, 3894926891UL, 3909137812UL, 3918622412UL, 3932865318UL, 3942371277UL, 3947127467UL, 3950299451UL};

  // A primitive 2*kMaxNbModuli (i.e., 2**16) root of unity for each one of the moduli
  static constexpr value_type primitive_roots[kMaxNbModuli] = { 31849551UL, 356382027UL, 467961354UL, 257997683UL, 193971320UL, 986867018UL, 78897767UL, 141225606UL, 731415844UL, 481144344UL, 917696061UL, 824741354UL, 451941790UL, 511843912UL, 135407195UL, 268428099UL, 1043510723UL, 1027110081UL, 195647351UL, 716805350UL, 113557401UL, 987845126UL, 465868585UL, 930935832UL, 711950136UL, 600277758UL, 736842454UL, 683080388UL, 459510224UL, 1051308252UL, 789600351UL, 935970884UL, 1013911055UL, 564224276UL, 45722012UL, 811581154UL, 281582338UL, 736594740UL, 509029995UL, 538290980UL, 970852006UL, 637408511UL, 909804798UL, 496492720UL, 26918549UL, 955604559UL, 611725686UL, 291936538UL, 389257815UL, 237393427UL, 822698849UL, 484758567UL, 725180172UL, 612238799UL, 273298163UL, 288882155UL, 248109450UL, 561794780UL, 412389194UL, 50998274UL, 744457459UL, 292205063UL, 404202187UL, 130586100UL, 572693692UL, 296054776UL, 980379721UL, 240458115UL, 33422515UL, 753620756UL, 595727672UL, 749845421UL, 515881690UL, 906263522UL, 58596697UL, 582232621UL, 623063662UL, 377670161UL, 417994872UL, 363098156UL, 409390188UL, 382395118UL, 802423663UL, 599312286UL, 485258993UL, 123542277UL, 950144517UL, 822711287UL, 61354328UL, 130725897UL, 50393163UL, 935574104UL, 668222478UL, 83644338UL, 146114408UL, 421485125UL, 51711619UL, 597301808UL, 529986259UL, 492274105UL, 629671588UL, 678509228UL, 256722117UL, 716060156UL, 303501520UL, 947258284UL, 324690155UL, 696499346UL, 838122960UL, 289705620UL, 673140871UL, 736895916UL, 275896460UL, 64254247UL, 62185961UL, 985535037UL, 555391276UL, 349922125UL, 382888865UL, 955727212UL, 720292378UL, 57152593UL, 790880360UL, 772379300UL, 140261556UL, 766563632UL, 333021694UL, 263951156UL, 482050352UL, 76882539UL, 889521330UL, 223642152UL, 306060368UL, 485542901UL, 315992970UL, 32684578UL, 863182060UL, 200815263UL, 737807518UL, 817342606UL, 657389593UL, 616477502UL, 947051752UL, 667104651UL, 206420650UL, 681430749UL, 147878222UL, 42184139UL, 460204383UL, 102333812UL, 434691353UL, 893707921UL, 551058918UL, 568322430UL, 549779534UL, 235021553UL, 468703120UL, 506133797UL, 289912723UL, 360492011UL, 266554416UL, 544987643UL, 130513888UL, 588868428UL, 257446540UL, 267350033UL, 82940242UL, 888223888UL, 143616268UL, 524108179UL, 546700839UL, 285958595UL, 90709153UL, 759541963UL, 914547620UL, 452044030UL, 726905514UL, 764019890UL, 524189590UL, 274796890UL, 2388500UL, 373751831UL, 830340131UL, 692434233UL, 640939471UL, 363731365UL, 229329593UL, 119932545UL, 928409591UL, 348209485UL, 910186139UL, 438669643UL, 16032812UL, 588919169UL, 726952419UL, 735369453UL, 279036188UL, 788979514UL, 176321352UL, 27773270UL, 864636230UL, 614213393UL, 681871177UL, 233724697UL, 534389769UL, 271129484UL, 103843851UL, 456813507UL, 679435667UL, 609772346UL, 58054184UL, 635762979UL, 364525743UL, 517123079UL, 593689351UL, 647589910UL, 180901548UL, 125805246UL, 783016646UL, 85057029UL, 805997399UL, 649559343UL, 635321450UL, 472329012UL, 334277855UL, 545637012UL, 246464126UL, 84790531UL, 586558770UL, 261980830UL, 714315319UL, 303146283UL, 146808625UL, 832766494UL, 823970685UL, 879401241UL, 352864877UL, 484613343UL, 364729393UL, 806935761UL, 782859138UL, 421938482UL, 488097109UL, 172788362UL, 249165274UL, 26921129UL, 638071656UL, 505012294UL, 889007407UL, 563970147UL, 98911320UL, 342881086UL, 145937642UL, 355719080UL, 112206860UL, 288794207UL, 85452402UL, 376073954UL, 774199808UL, 843044492UL, 454572415UL, 729432259UL, 789368793UL, 705829775UL, 43171563UL, 422829216UL, 523524573UL, 689989113UL, 458602141UL, 143121466UL, 366097039UL, 277392906UL, 196514158UL, 455703634UL, 801714871UL, 390468618UL, 155793404UL, 188395428UL, 376333671UL, 622545404UL, 219288049UL, 600175757UL, 524092569UL, 321406558UL, 672786289UL, 441231750UL, 103690650UL, 23085763UL, 128280706UL, 327635561UL, 558592916UL};


  // Inverses of kMaxPolyDegree (for the other degrees it can be derived easily)
  // for the different moduli
  static constexpr value_type invkMaxPolyDegree[kMaxNbModuli] = { 1073446921UL, 1072463911UL, 1071480901UL, 1070694493UL, 1069187211UL, 1068531871UL, 1068400803UL, 1068204201UL, 1065779443UL, 1065451773UL, 1064665365UL, 1063420219UL, 1063289151UL, 1063027015UL, 1062830413UL, 1062502743UL, 1062437209UL, 1061060995UL, 1060733325UL, 1060667791UL, 1060143519UL, 1058177499UL, 1056408081UL, 1056145945UL, 1055228469UL, 1054179925UL, 1053983323UL, 1053786721UL, 1052803711UL, 1052476041UL, 1051689633UL, 1049068273UL, 1048740603UL, 1048675069UL, 1048347399UL, 1045398369UL, 1043432349UL, 1042383805UL, 1041662931UL, 1040876523UL, 1040810989UL, 1040024581UL, 1038713901UL, 1038124095UL, 1037272153UL, 1036747881UL, 1034781861UL, 1033929919UL, 1032619239UL, 1032226035UL, 1032160501UL, 1031636229UL, 1030587685UL, 1029277005UL, 1028425063UL, 1026655645UL, 1026459043UL, 1026131373UL, 1025672635UL, 1023116809UL, 1022133799UL, 1021412925UL, 1021216323UL, 1020560983UL, 1019774575UL, 1019577973UL, 1019446905UL, 1018398361UL, 1018070691UL, 1017808555UL, 1016891079UL, 1016432341UL, 1015252729UL, 1014335253UL, 1012959039UL, 1012893505UL, 1012565835UL, 1012303699UL, 1011976029UL, 1010993019UL, 1010730883UL, 1010534281UL, 1009944475UL, 1008764863UL, 1008240591UL, 1007650785UL, 1006077969UL, 1005619231UL, 1005488163UL, 1005029425UL, 1004505153UL, 1004308551UL, 1002735735UL, 1002342531UL, 1000769715UL, 1000179909UL, 999917773UL, 999393501UL, 999131365UL, 998541559UL, 998213889UL, 997230879UL, 996247869UL, 995592529UL, 995002723UL, 994871655UL, 994675053UL, 994216315UL, 993888645UL, 993298839UL, 993233305UL, 992053693UL, 991857091UL, 991332819UL, 991267285UL, 990546411UL, 989956605UL, 988973595UL, 988908061UL, 988580391UL, 986352235UL, 985631361UL, 985434759UL, 984976021UL, 984451749UL, 983796409UL, 982420195UL, 982026991UL, 981240583UL, 980716311UL, 980126505UL, 979077961UL, 978750291UL, 977963883UL, 977505145UL, 976325533UL, 976194465UL, 975801261UL, 975604659UL, 975145921UL, 974949319UL, 974228445UL, 973376503UL, 972000289UL, 971869221UL, 971213881UL, 970099803UL, 969116793UL, 967478443UL, 967150773UL, 966167763UL, 964529413UL, 962825529UL, 962563393UL, 962366791UL, 961056111UL, 959090091UL, 958893489UL, 958107081UL, 957910479UL, 957648343UL, 957517275UL, 957320673UL, 956337663UL, 955354653UL, 954502711UL, 954306109UL, 952405623UL, 952209021UL, 952012419UL, 951553681UL, 950439603UL, 950374069UL, 949980865UL, 949653195UL, 949587661UL, 949391059UL, 948670185UL, 948604651UL, 947818243UL, 946310961UL, 944541543UL, 944148339UL, 943689601UL, 942772125UL, 941395911UL, 940543969UL, 939626493UL, 938446881UL, 936284259UL, 935301249UL, 935235715UL, 933859501UL, 933073093UL, 932942025UL, 932876491UL, 932548821UL, 930713869UL, 929992995UL, 929927461UL, 929337655UL, 927633771UL, 927043965UL, 926192023UL, 925864353UL, 924815809UL, 924684741UL, 924422605UL, 924226003UL, 922849789UL, 922522119UL, 921866779UL, 921473575UL, 920490565UL, 920293963UL, 919573089UL, 919310953UL, 918524545UL, 918196875UL, 917541535UL, 917148331UL, 916361923UL, 915968719UL, 914985709UL, 914658039UL, 914068233UL, 913871631UL, 913281825UL, 913216291UL, 912102213UL, 911053669UL, 910463863UL, 909742989UL, 909349785UL, 909153183UL, 908301241UL, 908170173UL, 908104639UL, 907776969UL, 907514833UL, 907383765UL, 907187163UL, 906990561UL, 906335221UL, 904238133UL, 903255123UL, 903058521UL, 902599783UL, 902403181UL, 900895899UL, 900830365UL, 900437161UL, 899650753UL, 898274539UL, 897684733UL, 897553665UL, 897291529UL, 896963859UL, 896701723UL, 896177451UL, 895980849UL, 894932305UL, 893228421UL, 893031819UL, 892376479UL, 891590071UL, 890410459UL, 889427449UL, 889296381UL, 889099779UL, 889034245UL, 888641041UL, 887461429UL, 885692011UL, 885495409UL, 883922593UL, 882218709UL, 881956573UL, 881563369UL, 880842495UL, 880776961UL, 880187155UL, 879204145UL, 876648319UL, 875272105UL, 874682299UL, 874289095UL, 873699289UL, 873306085UL, 873109483UL, 872978415UL};
};
} // namespace yell
